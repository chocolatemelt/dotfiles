"use strict";var app=angular.module("ShortkeysOptions",["ui.bootstrap","ui.codemirror","localytics.directives"]);app.controller("ShortkeysOptionsCtrl",["$scope",function(a){a.editorOptions={lineWrapping:!0,autoCloseBrackets:!0,mode:"javascript"},a.actionOptions=[{value:"top",label:"Scroll to top",group:"Scrolling"},{value:"bottom",label:"Scroll to bottom",group:"Scrolling"},{value:"scrolldown",label:"Scroll down",group:"Scrolling"},{value:"scrolldownmore",label:"Scroll down more",group:"Scrolling"},{value:"scrollup",label:"Scroll up",group:"Scrolling"},{value:"scrollupmore",label:"Scroll up more",group:"Scrolling"},{value:"scrollright",label:"Scroll right",group:"Scrolling"},{value:"scrollrightmore",label:"Scroll right more",group:"Scrolling"},{value:"scrollleft",label:"Scroll left",group:"Scrolling"},{value:"scrollleftmore",label:"Scroll left more",group:"Scrolling"},{value:"back",label:"Go back",group:"Location"},{value:"forward",label:"Go forward",group:"Location"},{value:"reload",label:"Reload page",group:"Location"},{value:"copyurl",label:"Copy URL",group:"Location"},{value:"openbookmark",label:"Open Bookmark/Bookmarklet",group:"Location"},{value:"gototab",label:"Jump to tab or URL",group:"Tabs"},{value:"newtab",label:"New tab",group:"Tabs"},{value:"closetab",label:"Close tab",group:"Tabs"},{value:"onlytab",label:"Close other tabs",group:"Tabs"},{value:"clonetab",label:"Duplicate tab",group:"Tabs"},{value:"nexttab",label:"Next tab",group:"Tabs"},{value:"prevtab",label:"Previous tab",group:"Tabs"},{value:"firsttab",label:"First tab",group:"Tabs"},{value:"lasttab",label:"Last tab",group:"Tabs"},{value:"togglepin",label:"Pin/unpin tab",group:"Tabs"},{value:"movetableft",label:"Move tab left",group:"Tabs"},{value:"movetabright",label:"Move tab right",group:"Tabs"},{value:"zoomin",label:"Zoom In",group:"Zooming"},{value:"zoomout",label:"Zoom Out",group:"Zooming"},{value:"zoomreset",label:"Reset Zoom",group:"Zooming"},{value:"javascript",label:"Run JavaScript",group:"Other"},{value:"cleardownloads",label:"Clear downloads",group:"Other"},{value:"disable",label:"Do nothing (disable Chrome shortcut)",group:"Other"},{value:"buttonnexttab",label:"Click button and switch to next tab (for Tribal Wars players)",group:"Other"}],a.alerts=[{type:"warning",msg:"You MUST reload your browser or tabs after making changes here!"}],a.closeAlert=function(b){a.alerts.splice(b,1)};var b=function(c){for(var d=0;d<c.length;d++)a.bookmarks.push(c[d].title),c[d].children&&b(c[d].children)};a.bookmarks=[],chrome.bookmarks.getTree(function(c){b(c),a.bookmarks.sort(),a.bookmarks=a.bookmarks.filter(function(a){return""!==a})}),a.actionToLabel=function(b){if("none"===b)return"New keyboard shortcut";for(var c=0,d=a.actionOptions.length;d>c;c++)if(a.actionOptions[c].value===b)return a.actionOptions[c].label},a.keys=[],a.addBlankIfEmpty=function(){0===a.keys.length&&a.addEmpty()},a.addEmpty=function(){a.keys.push({key:"",action:"none",blacklist:!1,sites:"*mail.google.com*",open:!0})},a.deleteKey=function(b){a.keys.splice(b,1)},a.saveKeys=function(){a.keys=a.keys.filter(function(a){return a&&""!==a.key});for(var b=0;b<a.keys.length;b++)a.keys[b].open=!1,"string"==typeof a.keys[b].sites?a.keys[b].sitesArray=a.keys[b].sites.split("\n"):a.keys[b].sitesArray=a.keys[b].sites;var c={keys:a.keys};chrome.storage.sync.set(c,function(){}),localStorage.shortkeys=JSON.stringify(c),a.alerts=[{type:"success",msg:"Your settings were saved! Remember to reload the window or individual tabs to pick up the changes."}],a.addBlankIfEmpty(),window.scroll(0,0)},chrome.storage.sync.get(null,function(b){if(b&&b.keys)a.keys=b.keys;else{var c=localStorage.shortkeys;if(c){var d=JSON.parse(c);a.keys=d.keys||[]}}a.addBlankIfEmpty(),a.$apply()})}]);